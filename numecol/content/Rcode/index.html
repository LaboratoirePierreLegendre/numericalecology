---
title: R-language functions |&nbsp;NumericalEcology.com
---

## R-language functions

* Anova and t-tests

  * <a href="http://adn.biol.umontreal.ca/~numericalecology/labo/fonctions_r/anova.1way.R.zip"> anova.1way.R </a> (P. Legendre): One-way anova with permutation test.	
  * <a href="http://adn.biol.umontreal.ca/~numericalecology/labo/fonctions_r/anova.2way.R.zip"> anova.2way.R </a> (P. Legendre): Two-way crossed-factor anova with permutation tests (balanced design): models I, II, and III.
  * <a href="http://adn.biol.umontreal.ca/~numericalecology/labo/fonctions_r/anova.2way.unbalanced.R.zip"> anova.2way.unbalanced.R </a> (P. Legendre): 2-way multivariate anova (by RDA) for balanced or unbalanced designs for 2 fixed crossed factors, with permutation tests.
  * <a href="http://adn.biol.umontreal.ca/~numericalecology/labo/fonctions_r/anova.3way.R.zip"> anova.3way.R </a> (P. Legendre): Three-way crossed-factor anova (fixed factors) with permutation tests (balanced design).
  * <a href="http://adn.biol.umontreal.ca/~numericalecology/labo/fonctions_r/nest.anova.perm.R.zip"> nest.anova.perm.R </a> (D. Borcard and P. Legendre): Nested anova with permutation tests (main factor and one nested factor, balanced design).
  * <a href="http://adn.biol.umontreal.ca/~numericalecology/labo/fonctions_r/t.perm.R.zip"> t.perm.R </a> (P. Legendre): t-test for independent samples with permutation test.
  * <a href="http://adn.biol.umontreal.ca/~numericalecology/labo/fonctions_r/t.paired.perm.R.zip"> t.paired.perm.R </a> (P. Legendre & G. Blanchet): t-test for related samples with permutation test.

* <a href="http://adn.biol.umontreal.ca/~numericalecology/labo/fonctions_r/beta-diversity.zip"> beta.div </a>  (four functions and documentation) 
  * beta.div (P. Legendre): This function computes estimates of the total beta diversity as the total variance in a community data matrix Y, for 17 dissimilarity coefficients or the raw data table. It also computes the species contributions (SCBD) and the local contributions (LCBD) to beta diversity.
  * beta.div.comp (P. Legendre): Podani and Baselga decompositions of a dissimilarity matrix into Replacement and Richness/Abundance difference components. The function can handle species presence-absence or abundance data, or biomasses per species. See the Legendre (2014) paper. Appendix 5 of that paper contains a function to compute LCBD indices from a Dissimilarity, Replacement, or Richness/Abundance difference matrix.
  * LCBD.comp (P. Legendre): This function computes local contributions to beta diversity (LCBD indices) from a symmetric dissimilarity matrix (D) or from a beta component matrix (Repl, RichDiff or AbDiff, or Nes).
  * TBI (P. Legendre): This function computes the differences between multivariate observations (frequency or presence-absence data) forming pairs observed at times T1 and T2. Temporal Beta-diversity Indices (TBI) are computed and tested. TBI are dissimilarity indices that measure beta differentiation through time. They are computed separately between T1 and T2 for each site.

* <a href="http://cc.oulu.fi/~jarioksa/softhelp/vegan.html">bgdispersal</a> (P. Legendre): Coefficients of biogeographical dispersal direction. Incorporated into the vegan library.

* <a href="http://adn.biol.umontreal.ca/~numericalecology/labo/fonctions_r/broken.stick.R.zip"> broken.stick.R </a> (P. Legendre): Computes the expected values of the broken-stick distribution.

* CADM: (P. Legendre): Concordance among several distance matrices. This function is now available in the <a href="http://cran.r-project.org/web/packages/ape/index.html">ape</a> library for phylogenetic analysis.

* Canonical correspondence analysis (CCA)

  * <a href="http://adn.biol.umontreal.ca/~numericalecology/labo/fonctions_r/CCA.zip">CCA</a> (P. Legendre): Demonstration function for canonical correspondence analysis (ter Braak 1986, 1987), following the algorithm described in Subsection 11.2.1 of Legendre and Legendre (1998).


* Canonical redundancy analysis (RDA)

  * <a href="http://adn.biol.umontreal.ca/~numericalecology/labo/fonctions_r/rdaTest.tar.gz"> rdaTest </a> (P. Legendre and S. Durand): R library to compute simple and partial canonical redundancy analysis (RDA) with permutation test and draw triplots of the results. Older versions of these functions are also found in the library sonarX, which is distributed on the ESA Web page <a href="http://esapubs.org/archive/">http://esapubs.org/archive/</a>, inside "Ecological Archives A016-047-S1". <font color="red">R library modified April 2014.</font>

    * <a href="http://adn.biol.umontreal.ca/~numericalecology/labo/fonctions_r/rdaTest.tar.gz"> rdaTest </a>, cross-platform source (R 3.0x)
    * <a href="http://adn.biol.umontreal.ca/~numericalecology/labo/fonctions_r/rdaTest_1.11.zip"> rdaTest </a> library for Windows (tested on R 3.0x)
    * <a href="http://adn.biol.umontreal.ca/~numericalecology/labo/fonctions_r/rdaTest_1.11.tgz"> rdaTest </a> library for Mac (tested on R 3.0x)
    * <a href="http://adn.biol.umontreal.ca/~numericalecology/labo/fonctions_r/rdaTest_1.7-old.zip"> rdaTest </a> library for Windows (for older versions of R)
    * <a href="http://adn.biol.umontreal.ca/~numericalecology/labo/fonctions_r/rdaTest_1.7.tar.gz"> rdaTest </a> library for Mac (for older versions of R)

  * <a href="http://adn.biol.umontreal.ca/~numericalecology/labo/fonctions_r/AdjustedRsquare.R.zip"> AdjustedRsquare.R </a> (P. Legendre): This function computes adjusted R-squares for two types of regression.
  * <a href="http://adn.biol.umontreal.ca/~numericalecology/labo/fonctions_r/dbRDA.D.R.zip"> dbRDA.D.R </a> (P. Legendre): This function computes the dbRDA F-test of significance for distance matrices that have, or not, the Euclidean property, following the algorithm of McArdle &amp; Anderson (2001). The F-statistic is obtained without computation of the eigenvalues and eigenvectors, hence no correction has to be made to the D matrix to eliminate the negative eigenvalues.


* <a href="http://cc.oulu.fi/~jarioksa/softhelp/vegan.html">cascadeKM</a> (S. Durand, M.-H. Ouellette and P. Legendre): Wrapper for the kmeans function for K-means partitioning. It creates several partitions forming a cascade from a small to a large number of groups. Incorporated into the vegan library. <br> Also distributed as part of the "Ecological Archives A016-047-S1" on the ESA Web page <a href="http://esapubs.org/archive/appl/A016/047/">http://esapubs.org/archive/appl/A016/047/</a>.

* <a href="http://adn.biol.umontreal.ca/~numericalecology/labo/fonctions_r/CCorA.zip"> CCorA </a> (P. Legendre): Canonical and partial canonical correlation analysis, Y <-> X1/X2. A version of that function for the calculation of simple canonical correlation analysis is found in the <a href="http://cran.r-project.org/web/packages/vegan/">vegan</a> library.

* <a href="http://adn.biol.umontreal.ca/~numericalecology/labo/fonctions_r/const.clust_1.3.tar.gz"> const.clust </a> (P. Legendre): R package to compute space-constrained or time-constrained agglomerative clustering from a dissimilarity matrix computed from multivariate data. The different solutions are tested by cross-validation. The clustering results are presented in the form of maps. <font color="red">R library modified March 30th, 2014.</font>

  * Versions for R 3.0
    * <a href="http://adn.biol.umontreal.ca/~numericalecology/labo/fonctions_r/const.clust_1.3.tar.gz"> const.clust </a>, cross-platform source
    * <a href="http://adn.biol.umontreal.ca/~numericalecology/labo/fonctions_r/const.clust_1.3.zip"> const.clust </a> library for Windows (R 3.01)
    * <a href="http://adn.biol.umontreal.ca/~numericalecology/labo/fonctions_r/const.clust_1.3.tgz"> const.clust </a> library for Mac (R 3.01)
  * Versions for R 2.12
    * <a href="http://adn.biol.umontreal.ca/~numericalecology/labo/fonctions_r/const.clust_1.2.zip"> const.clust </a> library for Windows (tested on R 2.12)
    * <a href="http://adn.biol.umontreal.ca/~numericalecology/labo/fonctions_r/const.clust_1.2.tgz"> const.clust </a> library for Mac (R 2.12)


* <a href="http://adn.biol.umontreal.ca/~numericalecology/labo/fonctions_r/corPerm.R.zip"> corPerm.R </a> (P. Legendre): Three functions to test the Pearson correlation coefficient by permutation.

* <a href="http://adn.biol.umontreal.ca/~numericalecology/labo/fonctions_r/dagnelie.test.R.zip"> dagnelie.test.R </a> (D. Borcard, P. Legendre): Pierre Dagnelie&#8217;s test of multinormality.

* Forward selection of explanatory variables in multiple regression and redundancy analysis (RDA)

  * <a href="http://r-forge.r-project.org/R/?group_id=195">packfor</a> (S. Dray, P. Legendre and G. Blanchet): Compiled package containing the functions "forward.sel" and "forward.sel.par".
    * R 3.0x Windows and Linux: AEM, packfor, PCNM and spacemakeR can be <a href="http://r-forge.r-project.org/R/?group_id=195"> found on the r-forge site </a>
    * R 3.0x Mac OSX download them here
      * <a href="http://adn.biol.umontreal.ca/~numericalecology/labo/fonctions_r/AEM_0.5-1.tgz"> AEM </a> library for Mac OSX (R 3.0x)
      * <a href="http://adn.biol.umontreal.ca/~numericalecology/labo/fonctions_r/packfor_0.0-8.tgz"> packfor </a> library for Mac OSX (R 3.0x)
      * <a href="http://adn.biol.umontreal.ca/~numericalecology/labo/fonctions_r/PCNM_2.1-4.tgz"> PCNM </a> library for Mac OSX (R 3.0x)
      * <a href="http://adn.biol.umontreal.ca/~numericalecology/labo/fonctions_r/spacemakeR_0.0-5.tgz"> spacemakeR </a> library for Mac OSX (R 3.0x)

* <a href="http://pbil.univ-lyon1.fr/members/dray/">fourthcorner</a> (S. Dray): Fourth-corner analysis.

* Functional diversity: <A HREF="http://cran.r-project.org/web/packages/FD/">FD library</A> (&Eacute;tienne Lalibert&eacute;)

* <a href="http://adn.biol.umontreal.ca/~numericalecology/labo/fonctions_r/hclust.PL.R.zip">hclust.PL</a> (P. Legendre): New version of the function "hclust" of {stats}, where the Fortran subroutine hclust.f has been recoded in R language for easy modification. This version is used in the followig paper: Murtagh, F. and P. Legendre "Ward&rsquo;s hierarchical agglomerative clustering method: which algorithms implement Ward&rsquo;s criterion?" (submitted paper). 

* Indicator / diagnostic species analyses: '<a href="http://vegmod.ctfc.cat">indicspecies</a>' library: R package section.

* Kendall.W: Species associations through Kendall's coefficient of concordance. Functions&nbsp;kendall.global() et kendall.post() forming this library are&nbsp;now integrated into the <a href="http://cran.r-project.org/web/packages/vegan/">vegan</a> library for community analysis.

* Linear regression

  * <a href="http://adn.biol.umontreal.ca/~numericalecology/labo/fonctions_r/multRegress.R.zip"> multRegress.R </a> (P. Legendre): This function computes a multiple regression and tests the coefficient of determination (R-square) by permutation.
  * <a href="http://cran.r-project.org/web/packages/lmodel2/index.html">lmodel2</a> (P. Legendre): Package to compute model II simple linear regression using ordinary least squares (OLS), major axis (MA), standard major axis (SMA), and ranged major axis (RMA). Available on the <a href="http://cran.r-project.org/"><a href="http://cran.r-project.org/web/packages/lmodel2/index.html"><a href="http://cran.r-project.org/">CRAN</a></a></a> page.
  * lmorigin (P. Legendre): Package to compute multiple linear regressions with permutation tests. The program includes regression through the origin, to be used in particular for the analysis of independent contrast data. This function is now available in the <a href="http://cran.r-project.org/web/packages/ape/index.html">ape</a> library for phylogenetic analysis.


* <a href="http://adn.biol.umontreal.ca/~numericalecology/labo/fonctions_r/manova.2way.unbalanced.R.zip"> manova.2way.unbalanced.R </a>&nbsp;(P. Legendre): manova for univariate or multivariate response data, two crossed factors, balanced or unbalanced design.

* <a href="http://www.elaliberte.info/rsourcecode">manovRDa.R</a> (E. Lalibert&eacute;): Two-way Manova-like RDA for fixed or random factors.

* mantel.correlog (P. Legendre): Package to compute a multivariate Mantel correlogram. This function is now available in the <a href="http://cran.r-project.org/web/packages/vegan/">vegan</a> library for community analysis.

* parafit (P. Legendre): Package to test host-parasite coevolution. This function is now available in the <a href="http://cran.r-project.org/web/packages/ape/index.html">ape</a> library for phylogenetic analysis.

* PCNM, MEM and AEM spatial eigenfunctions

  * <A HREF="http://r-forge.r-project.org/R/?group_id=195">PCNM</A> library: PCNM spatial eigenfunction analysis and principal coordinate analysis. This library uses resources from the AEM and packfor libraries available at the same address, as well as resources from the vegan, ade4 and spdep libraries available from CRAN.
  * <A HREF="http://r-forge.r-project.org/R/?group_id=195">spacemakeR</A> library: spatial analysis by MEM eigenfunctions (S. Dray).
  * <A HREF="http://r-forge.r-project.org/R/?group_id=195">AEM</A> library: Analysis of responses to directional spatial processes by AEM eigenfunctions (G. Blanchet).


* Periodograms

  * <a href="http://adn.biol.umontreal.ca/~numericalecology/labo/fonctions_r/periodograph.zip"> Periodograph </a> (P. Legendre): Contingency periodogram
  * <a href="http://adn.biol.umontreal.ca/~numericalecology/labo/fonctions_r/WR.tar.gz">Whittaker-Robinson periodogram</a> (P. Legendre): Periodic analysis of univariate quantitative data series.<br/>
  New, faster version, based on C code, compiled for Mac OSX and Windows platforms in April 2014.
    * <a href="http://adn.biol.umontreal.ca/~numericalecology/labo/fonctions_r/WR.tar.gz"> WR </a>, cross-platform source
    * <a href="http://adn.biol.umontreal.ca/~numericalecology/labo/fonctions_r/WR_1.0.zip"> WR </a> library for Windows (R 3.0x)
    * <a href="http://adn.biol.umontreal.ca/~numericalecology/labo/fonctions_r/WR_1.0.tgz"> WR </a> library for Mac (R 3.0x)

* <a href="http://adn.biol.umontreal.ca/~numericalecology/labo/fonctions_r/seriation.zip"> seriation.R</a> (P. Legendre and S. Durand ): Seriation method of Beum &amp; Brundage (1950) for non-symmetric or symmetric resemblance matrices

* sonarX (S. Durand et P. Legendre): Library for the extraction and analysis of single-beam sonar signals for benthic habitat detection. Distributed as part of the "Ecological Archives A016-047-S1" on the ESA Web page <a href="http://esapubs.org/archive/appl/A016/047/">http://esapubs.org/archive/appl/A016/047/</a>.

* <a href="http://adn.biol.umontreal.ca/~numericalecology/labo/fonctions_r/Sidak.R.zip"> Sidak.R </a> (P. Legendre): Bonferroni and Sidak corrections for multiple testing.

* Simple ordinations

  * <a href="http://adn.biol.umontreal.ca/~numericalecology/labo/fonctions_r/PCA.zip">PCA</a> (P. Legendre): Principal component analysis (PCA).
  * <a href="http://adn.biol.umontreal.ca/~numericalecology/labo/fonctions_r/CA.zip">CA</a> (P. Legendre): Correspondence analysis (CA).


* sonarX (S. Durand and P. Legendre): Extraction and analysis of single-beam sonar signals for benthic habitat detection and mapping. Package distributed as part of the "Ecological Archives A016-047-S1" on the ESA Web page <a href="http://esapubs.org/archive/appl/A016/047/">http://esapubs.org/archive/appl/A016/047/</a>.

* STI: test of space-time interaction in sampling design without replication: library distributed on the Software page of Miquel De C&aacute;ceres at <a href="http://vegmod.ctfc.cat">http://vegmod.ctfc.cat</a>

* <a href="http://cc.oulu.fi/~jarioksa/softhelp/vegan.html">varpart</a> (P. Legendre): Partition the variation of response table Y with respect to 2, 3, or 4 tables of explanatory variables. Incorporated into the vegan library.

* <a href="http://adn.biol.umontreal.ca/~numericalecology/reprints/Ten_years_of_vegan.pdf"> Ten years of vegan</a> (Jari Oksanen): A short history of the development of the vegan package before and since its release on CRAN on September 6, 2001.
